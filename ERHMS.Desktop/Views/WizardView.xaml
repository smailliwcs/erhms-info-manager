<Window x:Class="ERHMS.Desktop.Views.WizardView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:Behaviors="clr-namespace:ERHMS.Desktop.Behaviors"
        xmlns:Converters="clr-namespace:ERHMS.Desktop.Converters"
        xmlns:Properties="clr-namespace:ERHMS.Desktop.Properties"
        Icon="/ERHMS Info Manager;component/Resources/ERHMS.ico"
        Height="480"
        MinHeight="480"
        MinWidth="640"
        Width="640"
        SnapsToDevicePixels="True"
        Title="{x:Static Properties:ResX.AppTitle}"
        WindowStartupLocation="CenterOwner">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/ERHMS Info Manager;component/Resources/App.xaml" />
                <ResourceDictionary Source="/ERHMS Info Manager;component/Views/Wizards/CreateViewTemplates.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <ResourceDictionary x:Key="StepTitles"
                                Source="/ERHMS Info Manager;component/Views/Wizards/StepTitles.xaml" />
            <Converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
            <Converters:BoolToVisibilityInverter x:Key="BoolToVisibilityInverter" />
            <Converters:ObjectToResourceConverter x:Key="StepToTitleConverter"
                                                  Resources="{StaticResource StepTitles}" />
        </ResourceDictionary>
    </Window.Resources>
    <AutomationProperties.HelpText>
        <Binding Path="CurrentStep"
                 Converter="{StaticResource StepToTitleConverter}" />
    </AutomationProperties.HelpText>
    <b:Interaction.Behaviors>
        <Behaviors:RelayEventBehavior EventName="ExitRequested"
                                      HandlerName="DataContext_ExitRequested" />
    </b:Interaction.Behaviors>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Border Grid.Row="0"
                BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}"
                BorderThickness="0,1"
                SnapsToDevicePixels="True">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <Border Style="{StaticResource LayoutFull}">
                    <Grid Style="{StaticResource Container}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <DockPanel Grid.Row="0"
                                   Style="{StaticResource Section}">
                            <TextBlock Foreground="{DynamicResource AccentTextBrush}"
                                       Style="{StaticResource Lead}"
                                       Text="{Binding CurrentStep, Converter={StaticResource StepToTitleConverter}}">
                            </TextBlock>
                        </DockPanel>
                        <ContentPresenter Grid.Row="1"
                                          Content="{Binding CurrentStep}" />
                    </Grid>
                </Border>
            </ScrollViewer>
        </Border>
        <Border Grid.Row="1"
                Background="{DynamicResource {x:Static SystemColors.MenuBarBrushKey}}">
            <WrapPanel HorizontalAlignment="Right"
                       Style="{StaticResource Container}">
                <WrapPanel.Resources>
                    <Style TargetType="Button" BasedOn="{StaticResource DialogButton}" />
                </WrapPanel.Resources>
                <Button Command="{Binding CurrentStep.ReturnCommand}"
                        Visibility="{Binding CurrentStep.CanReturn, Converter={StaticResource BoolToVisibilityConverter}}">
                    _Back
                </Button>
                <Button Command="{Binding CurrentStep.ContinueCommand}"
                        Content="{Binding CurrentStep.ContinueText}"
                        IsDefault="True" />
                <Button Command="{Binding ExitCommand}"
                        IsCancel="True"
                        Visibility="{Binding Completed, Converter={StaticResource BoolToVisibilityInverter}}">
                    _Cancel
                </Button>
            </WrapPanel>
        </Border>
    </Grid>
</Window>
